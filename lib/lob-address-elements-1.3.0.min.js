"use strict";!function(){function t(i,n){var r=!1,a=!1;function l(e){var t=i("*[data-lob-"+e+"-id]").attr("data-lob-"+e+"-id");if(t)return i("#"+t);var s=i("*[data-lob-"+e+"-name]").attr("data-lob-"+e+"-name"),r=i("*[data-lob-"+e+"-class]").attr("data-lob-"+e+"-class");return i(s?"*[name="+s+"]":r?"."+r:"*[data-lob-"+e+"]")}function c(e){var t=l(e);return t.length&&t.attr("data-lob-"+e)||i("*[data-lob-"+e+"-value]").attr("data-lob-"+e+"-value")}function d(e){var t=l("verify");return t.length?t:l(e).closest("form")}function s(){var e=l("primary"),t=function(e){var t=["false","strict","normal","relaxed","passthrough"];if(e&&-1<t.indexOf(e))return e;var s=c("verify");return s&&-1<t.indexOf(s)?s:"normal"}(n.strictness),s="true"===c("verify-message")||d("primary").length&&!l("verify-message").length,r=e.length&&"false"!==c("primary"),i="false"!==t&&d("primary").length&&("passthrough"===t||l("verify-message").length||s);return{autocomplete:r,verify:i,enrich:i||r,create_message:s,strictness:t}}function e(t){var e=window.MutationObserver||window.WebKitMutationObserver;e&&new e(function(){var e=s();"untouched"===t&&e.enrich?(t="enriched",setTimeout(function(){m(i,n,e)},0)):"enriched"!==t||e.enrich||(t="untouched")}).observe(window.document.body,{subtree:!0,attributes:!0,childList:!0})}function m(i,e,n){var t,s,v={api_key:e.api_key||c("key"),strictness:n.strictness,denormalize:"false"!==c("secondary"),suppress_stylesheet:void 0!==(t=e.stylesheet)?!!t:0<l("suggestion-stylesheet").length,styles:e.styles||{"err-color":"#117ab8","err-bgcolor":"#eeeeee","suggestion-color":"#666666","suggestion-bgcolor":"#fefefe","suggestion-bordercolor":"#a8a8a8","suggestion-activecolor":"#117ab8","suggestion-activebgcolor":"#eeeeee"},elements:e.elements||{errorAnchorElement:l("verify-message-anchor"),form:d("primary"),message:l("verify-message").hide(),primary:l("primary"),primaryMsg:l("primary-message").hide(),secondary:l("secondary"),secondaryMsg:l("secondary-message").hide(),city:l("city"),cityMsg:l("city-message").hide(),state:l("state"),stateMsg:l("state-message").hide(),zip:l("zip"),zipMsg:l("zip-message").hide()},messages:e.messages||{primary_line:c("err-primary-line")||"Enter the Primary address.",city_state_zip:c("err-city-state-zip")||"Enter City and State (or Zip).",zip:c("err-zip")||"Enter a valid Zip.",undeliverable:c("err-undeliverable")||"The address could not be verified.",deliverable_missing_unit:c("err-missing-unit")||"Enter a Suite or Unit.",deliverable_unnecessary_unit:c("err-unnecessary-unit")||"Suite or Unit unnecessary.",deliverable_incorrect_unit:c("err-incorrect-unit")||"Incorrect Unit. Please confirm.",confirm:c("err-confirm")||"Did you mean",DEFAULT:c("err-default")||"Unknown Error. The address could not be verified."},apis:e.apis||{verify:"https://api.lob.com/v1/us_verifications",autocomplete:"https://api.lob.com/v1/us_autocompletions"},do:{init:function(){m(i,e)}}};function o(e,t,s){return c(t+"-"+s)||e.styles[t+"-"+s]}return n.autocomplete&&(v.suppress_stylesheet||r||(r=!0,i("<style>").prop("type","text/css").html("            .algolia-autocomplete {              display:"+("block"===v.elements.primary.css("display").toLowerCase()?"block":"")+";              width: "+("block"===(s=v).elements.primary.css("display").toLowerCase()?"100%":s.elements.primary.css("width")||s.elements.primary.outerWidth()+"px")+";              vertical-align: middle;            }            .aa-dropdown-menu {              width: 100%;              border: 1px solid "+o(v,"suggestion","bordercolor")+";              border-top: 0;              background-color: "+o(v,"suggestion","bgcolor")+";              overflow: hidden;              border-radius: 0 0 .25rem .25rem;              margin-top:-5px;            }            .aa-suggestion {              cursor: pointer;              padding: 6px 12px;              color: "+o(v,"suggestion","color")+";            }            .aa-suggestion:hover,            .aa-suggestion:active,            .aa-suggestion.aa-cursor  {              color: "+o(v,"suggestion","activecolor")+";              background-color: "+o(v,"suggestion","activebgcolor")+";            }            .aa-suggestion div {              white-space: nowrap !important;              overflow: hidden;              text-overflow: ellipsis;            }            .aa-suggestion span {              font-size: .8em;            }").appendTo("head")),v.do.autocomplete=function(e,t){if(e.match(/[A-Za-z0-9]/)){var s=new XMLHttpRequest,r=v.apis.autocomplete+"?av_elements_origin="+window.location.href;s.open("POST",r,!0),s.setRequestHeader("Content-Type","application/json"),v.api_key&&s.setRequestHeader("Authorization","Basic "+btoa(v.api_key+":")),s.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE)if(200===this.status)try{var e=JSON.parse(s.responseText);t(e.suggestions)}catch(e){t(null)}else 401===this.status&&console.log("Please sign up on lob.com to get a valid api key."),t(null)},s.send(JSON.stringify({address_prefix:e,city:v.elements.city.val(),zip_code:v.elements.zip.val(),state:v.elements.state.val(),geo_ip_sort:!0}))}return!1},v.do.apply=function(e){v.elements.primary.autocomplete("val",e.primary_line),v.elements.secondary.val(""),v.elements.city.val(e.city),v.elements.state.val(e.state),v.elements.zip.val(e.zip_code)},v.elements.primary.autocomplete({hint:!1},{source:v.do.autocomplete,templates:{suggestion:function(e){var t=i("<div></div>"),s=i("<span></span>");return t.text(e.primary_line+" "),s.text(e.city+", "+e.state+" "+e.zip_code),t.append(s),t}},cache:!1}).on("autocomplete:selected",function(e,t){v.do.apply(t)})),n.verify&&function(){function r(e,t){var s=i._data(e[0],"events");s[t].unshift(s[t].pop())}function u(e){return"primary_line is required or address is required"===e?"primary_line":"zip_code is required or both city and state are required"===e?"city_state_zip":"zip_code must be in a valid zip or zip+4 format"===e?"zip":e in v.messages?e:"DEFAULT"}if(n.create_message){var e=i('<div class="lob-verify-message"></div>'),t=v.elements.errorAnchorElement;t.length?e.insertBefore(t):v.elements.form.prepend(e),v.elements.message=e,a||(a=!0,i("<style>").prop("type","text/css").html("              .lob-verify-message {                display: none;                width: 100%;                border-radius: .25rem;                max-width: 100%;                position: relative;                left: 50%;                margin-right: -50%;                transform: translate(-50%, -50%);                text-align: center;                padding: .5rem;                margin-top: 1.5rem;                margin-bottom: 1.5rem;                color: "+o(v,"err","color")+";                background-color: "+o(v,"err","bgcolor")+";              }").appendTo("head"))}function p(e){var t,s,r=function(e,t){var s=e.components&&e.components.secondary_designator||"";if(e.secondary_line||!v.denormalize)return{secondary_line:e.secondary_line,primary_line:e.primary_line};if(s&&t){var r=e.primary_line.split(s);return{secondary_line:s+" "+r[1].trim(),primary_line:r[0].trim()}}return{secondary_line:e.secondary_line,primary_line:e.primary_line}}(e,!!v.elements.secondary.val());return{primary:r.primary_line,secondary:r.secondary_line,city:e.components&&e.components.city||"",state:e.components&&e.components.state||"",zip:(t=e.components,s=[],t.zip_code&&s.push(t.zip_code),t.zip_code_plus_4&&s.push(t.zip_code_plus_4),s.length?s.join("-"):"")}}function y(e,t){var s;t=void 0===t||t;var r=v.address=p(e);for(var i in r)if(r.hasOwnProperty(i)){var n=v.elements[i].val();!(r[i].toUpperCase()!==n.toUpperCase())||"zip"===i&&5===n.length&&0===r[i].indexOf(n)||(s=!0),t&&v.elements[i].val(r[i])}return s}function g(){v.elements.message.hide(),v.elements.primaryMsg.hide(),v.elements.secondaryMsg.hide(),v.elements.cityMsg.hide(),v.elements.stateMsg.hide(),v.elements.zipMsg.hide()}function f(e,t){for(var s in t)e=e.replace("{"+s+"}",t[s]);return e}v.do.message=function(e){e&&("confirm"===e.type?v.elements.message.html(e.msg).show("slow"):v.elements.message.text(e.msg).show("slow"),s[e.type]&&s[e.type](v.messages[e.type]))};var s={primary_line:function(e){v.elements.primaryMsg.text(e).show("slow")},city_state_zip:function(e){v.elements.cityMsg.text(e).show("slow"),v.elements.stateMsg.text(e).show("slow"),v.elements.zipMsg.text(e).show("slow")},zip:function(e){v.elements.zipMsg.text(e).show("slow")},deliverable_missing_unit:function(e){!v.denormalize&&v.elements.primaryMsg.text(e).show("slow")||v.elements.secondaryMsg.text(e).show("slow")},deliverable_unnecessary_unit:function(e){!v.denormalize&&v.elements.primaryMsg.text(e).show("slow")||v.elements.secondaryMsg.text(e).show("slow")},deliverable_incorrect_unit:function(e){!v.denormalize&&v.elements.primaryMsg.text(e).show("slow")||v.elements.secondaryMsg.text(e).show("slow")}};v.do.verify=function(d){v.submit="passthrough"===v.strictness,v.confirmed=function(){if("passthrough"!==v.strictness&&v.address){for(var e in v.address)if(v.address.hasOwnProperty(e)&&v.elements[e].val().toUpperCase()!==v.address[e].toUpperCase())return!1;return!0}return!1}();var e={primary_line:v.elements.primary.val(),secondary_line:v.elements.secondary.val(),city:v.elements.city.val(),state:v.elements.state.val(),zip_code:v.elements.zip.val()},m=new XMLHttpRequest,t=v.apis.verify+"?av_elements_origin="+window.location.href;return m.open("POST",t,!0),m.setRequestHeader("Content-Type","application/json"),v.api_key&&m.setRequestHeader("Authorization","Basic "+btoa(v.api_key+":")),m.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var e,t=function(e){try{return JSON.parse(e)}catch(e){return console.log("ERR",e),{error:{message:"DEFAULT"}}}}(m.responseText);if(this.status&&200!==this.status||t.statusCode&&200!==t.statusCode)401===this.status?(console.log("Please sign up on lob.com to get a valid api key."),d(null,!0)):(e=u((t=t&&t.body||t).error.message),d({msg:v.messages[e],type:e}));else if(t=t&&t.body||t,o=t,a=v,l=this.status,c=y(o,!1),!l||"deliverable"===o.deliverability&&!c||"undeliverable"===o.deliverability&&a.confirmed&&"relaxed"===a.strictness||"deliverable_missing_unit"===o.deliverability&&a.confirmed&&"strict"!==a.strictness||"deliverable_unnecessary_unit"===o.deliverability&&a.confirmed&&"strict"!==a.strictness||"deliverable_incorrect_unit"===o.deliverability&&a.confirmed&&"strict"!==a.strictness)d(null,!0);else if("deliverable"===t.deliverability){var s=(r=p(t),i=v.messages.confirm,n=f("{0} {1} {2} {3} {4}",[r.primary,r.secondary,r.city,r.state,r.zip]),f('<span style="cursor: pointer">{0} <span style="text-decoration: underline">{1}</span>?</span>',[i,n]));v.elements.message.click(function(){y(t),g(),v.elements.message.off("click")}),d({msg:s,type:"confirm"})}else e=u(t.deliverability),d({msg:v.messages[e],type:e})}var r,i,n,o,a,l,c},m.send(JSON.stringify(e)),!1},v.elements.form.on("submit",function s(e){return e.stopImmediatePropagation(),e.preventDefault(),g(),v.elements.message.off("click"),v.do.verify(function(e,t){v.submit?(v.do.message(e),v.elements.form.off("submit",s),v.submitted=!0,v.elements.form.submit(),v.elements.form.on("submit",s),r(v.elements.form,"submit")):t?(v.elements.form.off("submit",s),v.elements.form.submit()):v.do.message(e)})}),r(v.elements.form,"submit")}(),window.LobAddressElements=v}var t=s();return t.enrich?(e("enriched"),m(i,n,t)):(e("untouched"),{do:{init:function(){m(i,n,t)}}})}var s="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js",r="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.37.0/autocomplete.jquery.min.js",i={load:function(){var e=Array.prototype.slice.call(arguments[0]),t=i[e.shift()];t&&t.apply(this,e)},jquery:function(){if(window.jQuery)i.load(arguments);else{var e=arguments,t=document.createElement("script");t.onload=function(){i.load(e)},t.src=s,document.getElementsByTagName("body")[0].appendChild(t)}},jquery_autocomplete:function(){if(window.jQuery.fn.autocomplete)i.load(arguments);else{var e=document.createElement("script"),t=arguments;e.onload=function(){i.load(t)},e.src=r,document.getElementsByTagName("body")[0].appendChild(e)}},address_elements:function(){if(window.LobAddressElements)i.load(arguments);else{var e=window.LobAddressElementsConfig||{};window.LobAddressElements=new t(window.jQuery,e),i.load(arguments)}}};i.load(["jquery","jquery_autocomplete","address_elements"])}();
//# sourceMappingURL=lob-address-elements.min.js.map